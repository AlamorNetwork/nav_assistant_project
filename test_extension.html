<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>ØªØ³Øª Ø§Ú©Ø³ØªÙ†Ø´Ù† NAV</title>
    <style>
        body {
            font-family: 'Vazirmatn', sans-serif;
            background: linear-gradient(135deg, #1a1a1a 0%, #2d5a27 50%, #1a1a1a 100%);
            color: #c0c0c0;
            padding: 20px;
            direction: rtl;
        }
        .test-container {
            max-width: 600px;
            margin: 0 auto;
            background: rgba(45, 90, 39, 0.8);
            padding: 30px;
            border-radius: 15px;
            border: 2px solid #d4af37;
        }
        h1 {
            color: #d4af37;
            text-align: center;
            margin-bottom: 30px;
        }
        .test-section {
            margin: 20px 0;
            padding: 15px;
            background: rgba(26, 26, 26, 0.6);
            border-radius: 10px;
            border: 1px solid #4a4a4a;
        }
        .test-button {
            background: linear-gradient(145deg, #d4af37, #b8941f);
            color: #1a1a1a;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            margin: 5px;
        }
        .test-button:hover {
            background: linear-gradient(145deg, #b8941f, #d4af37);
        }
        .status {
            margin-top: 10px;
            padding: 10px;
            border-radius: 5px;
            font-family: monospace;
        }
        .success { background: rgba(72, 187, 120, 0.2); border: 1px solid #48bb78; }
        .error { background: rgba(245, 101, 101, 0.2); border: 1px solid #f56565; }
        .info { background: rgba(66, 153, 225, 0.2); border: 1px solid #4299e1; }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>ğŸ ØªØ³Øª Ø§Ú©Ø³ØªÙ†Ø´Ù† Ø³Ø¨Ø¯Ú¯Ø±Ø¯Ø§Ù† Ú©Ø§Ø±ÛŒØ²Ù…Ø§</h1>
        
        <div class="test-section">
            <h3>ØªØ³Øª Ø§ØªØµØ§Ù„ Ø¨Ù‡ Ø³Ø±ÙˆØ±</h3>
            <button class="test-button" onclick="testServerConnection()">ØªØ³Øª Ø§ØªØµØ§Ù„</button>
            <div id="serverStatus" class="status"></div>
        </div>
        
        <div class="test-section">
            <h3>ØªØ³Øª Ø§Ø­Ø±Ø§Ø² Ù‡ÙˆÛŒØª</h3>
            <input type="text" id="testUsername" placeholder="Ù†Ø§Ù… Ú©Ø§Ø±Ø¨Ø±ÛŒ" style="margin: 5px; padding: 8px; border-radius: 5px; border: 1px solid #4a4a4a; background: rgba(26, 26, 26, 0.8); color: #c0c0c0;">
            <input type="password" id="testPassword" placeholder="Ø±Ù…Ø² Ø¹Ø¨ÙˆØ±" style="margin: 5px; padding: 8px; border-radius: 5px; border: 1px solid #4a4a4a; background: rgba(26, 26, 26, 0.8); color: #c0c0c0;">
            <button class="test-button" onclick="testLogin()">ØªØ³Øª ÙˆØ±ÙˆØ¯</button>
            <div id="loginStatus" class="status"></div>
        </div>
        
        <div class="test-section">
            <h3>ØªØ³Øª Ø¯Ø±ÛŒØ§ÙØª ØµÙ†Ø¯ÙˆÙ‚â€ŒÙ‡Ø§</h3>
            <button class="test-button" onclick="testGetFunds()">Ø¯Ø±ÛŒØ§ÙØª ØµÙ†Ø¯ÙˆÙ‚â€ŒÙ‡Ø§</button>
            <div id="fundsStatus" class="status"></div>
        </div>
        
        <div class="test-section">
            <h3>ÙˆØ¶Ø¹ÛŒØª Ú©Ù„ÛŒ</h3>
            <div id="overallStatus" class="status info">
                Ø¢Ù…Ø§Ø¯Ù‡ Ø¨Ø±Ø§ÛŒ ØªØ³Øª...
            </div>
        </div>
    </div>

    <script>
        const API_BASE_URL = 'https://respina.irplatforme.ir';
        
        function updateStatus(elementId, message, type = 'info') {
            const element = document.getElementById(elementId);
            element.textContent = message;
            element.className = `status ${type}`;
        }
        
        async function testServerConnection() {
            updateStatus('serverStatus', 'Ø¯Ø± Ø­Ø§Ù„ ØªØ³Øª Ø§ØªØµØ§Ù„...', 'info');
            try {
                const response = await fetch(`${API_BASE_URL}/funds`);
                if (response.ok) {
                    updateStatus('serverStatus', 'âœ… Ø§ØªØµØ§Ù„ Ø¨Ù‡ Ø³Ø±ÙˆØ± Ù…ÙˆÙÙ‚', 'success');
                } else {
                    updateStatus('serverStatus', `âŒ Ø®Ø·Ø§ Ø¯Ø± Ø§ØªØµØ§Ù„: ${response.status}`, 'error');
                }
            } catch (error) {
                updateStatus('serverStatus', `âŒ Ø®Ø·Ø§ Ø¯Ø± Ø§ØªØµØ§Ù„: ${error.message}`, 'error');
            }
        }
        
        async function testLogin() {
            const username = document.getElementById('testUsername').value;
            const password = document.getElementById('testPassword').value;
            
            if (!username || !password) {
                updateStatus('loginStatus', 'âŒ Ù„Ø·ÙØ§Ù‹ Ù†Ø§Ù… Ú©Ø§Ø±Ø¨Ø±ÛŒ Ùˆ Ø±Ù…Ø² Ø¹Ø¨ÙˆØ± Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯', 'error');
                return;
            }
            
            updateStatus('loginStatus', 'Ø¯Ø± Ø­Ø§Ù„ ØªØ³Øª ÙˆØ±ÙˆØ¯...', 'info');
            try {
                const response = await fetch(`${API_BASE_URL}/auth/login`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ username, password })
                });
                
                const result = await response.text();
                if (response.ok) {
                    const data = JSON.parse(result);
                    updateStatus('loginStatus', `âœ… ÙˆØ±ÙˆØ¯ Ù…ÙˆÙÙ‚ - Ú©Ø§Ø±Ø¨Ø±: ${data.username}`, 'success');
                } else {
                    updateStatus('loginStatus', `âŒ ÙˆØ±ÙˆØ¯ Ù†Ø§Ù…ÙˆÙÙ‚: ${result}`, 'error');
                }
            } catch (error) {
                updateStatus('loginStatus', `âŒ Ø®Ø·Ø§ Ø¯Ø± ÙˆØ±ÙˆØ¯: ${error.message}`, 'error');
            }
        }
        
        async function testGetFunds() {
            updateStatus('fundsStatus', 'Ø¯Ø± Ø­Ø§Ù„ Ø¯Ø±ÛŒØ§ÙØª ØµÙ†Ø¯ÙˆÙ‚â€ŒÙ‡Ø§...', 'info');
            try {
                const response = await fetch(`${API_BASE_URL}/funds`);
                if (response.ok) {
                    const funds = await response.json();
                    updateStatus('fundsStatus', `âœ… ${funds.length} ØµÙ†Ø¯ÙˆÙ‚ Ø¯Ø±ÛŒØ§ÙØª Ø´Ø¯`, 'success');
                } else {
                    updateStatus('fundsStatus', `âŒ Ø®Ø·Ø§ Ø¯Ø± Ø¯Ø±ÛŒØ§ÙØª ØµÙ†Ø¯ÙˆÙ‚â€ŒÙ‡Ø§: ${response.status}`, 'error');
                }
            } catch (error) {
                updateStatus('fundsStatus', `âŒ Ø®Ø·Ø§ Ø¯Ø± Ø¯Ø±ÛŒØ§ÙØª ØµÙ†Ø¯ÙˆÙ‚â€ŒÙ‡Ø§: ${error.message}`, 'error');
            }
        }
        
        // ØªØ³Øª Ø§ÙˆÙ„ÛŒÙ‡ Ø§ØªØµØ§Ù„
        window.onload = function() {
            testServerConnection();
        };
    </script>
</body>
</html>
